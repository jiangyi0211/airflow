{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-12T06:54:13.955572Z", "invocation_id": "d2b85ece-efe9-4f7f-a4ab-56bac1f05328", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:53:52.723562Z", "completed_at": "2025-05-12T06:53:52.746014Z"}, {"name": "execute", "started_at": "2025-05-12T06:53:52.746478Z", "completed_at": "2025-05-12T06:53:57.156157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.434926271438599, "adapter_response": {"_message": "CREATE TABLE (4.4k rows, 11.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 4380, "bytes_processed": 11591218, "bytes_billed": 20971520, "location": "US", "project_id": "airflow-dataonline", "job_id": "9ee4a04e-5624-471b-aaf9-c087f53722ba", "slot_ms": 4844}, "message": "CREATE TABLE (4.4k rows, 11.1 MiB processed)", "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "-- dim_customer.sql\n\n-- Create the dimension table\nWITH customer_cte AS (\n\tSELECT DISTINCT\n\t    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n\t    Country AS country\n\tFROM `airflow-dataonline`.`retail`.`raw_invoices`\n\tWHERE CustomerID IS NOT NULL\n)\nSELECT\n    t.*,\n\tcm.iso\nFROM customer_cte t\nLEFT JOIN `airflow-dataonline`.`retail`.`country` cm ON t.country = cm.nicename", "relation_name": "`airflow-dataonline`.`retail`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:53:57.164178Z", "completed_at": "2025-05-12T06:53:57.169595Z"}, {"name": "execute", "started_at": "2025-05-12T06:53:57.170023Z", "completed_at": "2025-05-12T06:54:01.620026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.457985877990723, "adapter_response": {"_message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 23260, "bytes_processed": 8117969, "bytes_billed": 10485760, "location": "US", "project_id": "airflow-dataonline", "job_id": "31844315-37d5-4d9b-8c88-bf5144b2b591", "slot_ms": 4628}, "message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "-- dim_datetime.sql\n\n-- Create a CTE to extract date and time components\nWITH datetime_cte AS (  \n  SELECT DISTINCT\n    InvoiceDate AS datetime_id,\n    CASE\n      WHEN LENGTH(InvoiceDate) = 16 THEN\n        -- Date format: \"DD/MM/YYYY HH:MM\"\n        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)\n      WHEN LENGTH(InvoiceDate) <= 14 THEN\n        -- Date format: \"MM/DD/YY HH:MM\"\n        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)\n      ELSE\n        NULL\n    END AS date_part,\n  FROM `airflow-dataonline`.`retail`.`raw_invoices`\n  WHERE InvoiceDate IS NOT NULL\n)\nSELECT\n  datetime_id,\n  date_part as datetime,\n  EXTRACT(YEAR FROM date_part) AS year,\n  EXTRACT(MONTH FROM date_part) AS month,\n  EXTRACT(DAY FROM date_part) AS day,\n  EXTRACT(HOUR FROM date_part) AS hour,\n  EXTRACT(MINUTE FROM date_part) AS minute,\n  EXTRACT(DAYOFWEEK FROM date_part) AS weekday\nFROM datetime_cte", "relation_name": "`airflow-dataonline`.`retail`.`dim_datetime`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:54:01.629008Z", "completed_at": "2025-05-12T06:54:01.636080Z"}, {"name": "execute", "started_at": "2025-05-12T06:54:01.636583Z", "completed_at": "2025-05-12T06:54:06.223750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.59767746925354, "adapter_response": {"_message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 16282, "bytes_processed": 23656435, "bytes_billed": 24117248, "location": "US", "project_id": "airflow-dataonline", "job_id": "54e61aa0-93bf-4490-a6c7-e88ee6032c46", "slot_ms": 6491}, "message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "-- dim_product.sql\n-- StockCode isn't unique, a product with the same id can have different and prices\n-- Create the dimension table\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n\t\tStockCode AS stock_code,\n    Description AS description,\n    UnitPrice AS price\nFROM `airflow-dataonline`.`retail`.`raw_invoices`\nWHERE StockCode IS NOT NULL\nAND UnitPrice > 0", "relation_name": "`airflow-dataonline`.`retail`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:54:06.232183Z", "completed_at": "2025-05-12T06:54:06.242906Z"}, {"name": "execute", "started_at": "2025-05-12T06:54:06.243632Z", "completed_at": "2025-05-12T06:54:13.943212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.713473320007324, "adapter_response": {"_message": "CREATE TABLE (397.9k rows, 50.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 397884, "bytes_processed": 53090830, "bytes_billed": 53477376, "location": "US", "project_id": "airflow-dataonline", "job_id": "4cbad60e-a871-4686-a017-c42d4cf2f9a4", "slot_ms": 13638}, "message": "CREATE TABLE (397.9k rows, 50.6 MiB processed)", "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "-- fct_invoices.sql\n\n-- Create the fact table by joining the relevant keys from dimension table\nWITH fct_invoices_cte AS (\n    SELECT\n        InvoiceNo AS invoice_id,\n        InvoiceDate AS datetime_id,\n        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n        Quantity AS quantity,\n        Quantity * UnitPrice AS total\n    FROM `airflow-dataonline`.`retail`.`raw_invoices`\n    WHERE Quantity > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN `airflow-dataonline`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN `airflow-dataonline`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id\nINNER JOIN `airflow-dataonline`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id", "relation_name": "`airflow-dataonline`.`retail`.`fct_invoices`", "batch_results": null}], "elapsed_time": 24.019742727279663, "args": {"log_level_file": "debug", "partial_parse_file_diff": true, "source_freshness_run_project_hooks": false, "macro_debugging": false, "cache_selected_only": false, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "quiet": false, "populate_cache": true, "which": "run", "project_dir": "/usr/local/airflow/include/dbt", "require_nested_cumulative_type_params": false, "select": [], "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "print": true, "log_level": "info", "require_yaml_configuration_for_mf_time_spines": false, "defer": false, "write_json": true, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "invocation_command": "dbt run --profiles-dir /usr/local/airflow/include/dbt/", "log_format": "default", "log_path": "/usr/local/airflow/include/dbt/logs", "static_parser": true, "strict_mode": false, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "exclude": [], "require_resource_names_without_spaces": false, "empty": false, "warn_error_options": {"include": [], "exclude": []}, "state_modified_compare_vars": false, "partial_parse": true, "version_check": true, "log_format_file": "debug", "introspect": true, "skip_nodes_if_on_run_start_fails": false, "profiles_dir": "/usr/local/airflow/include/dbt/", "favor_state": false, "show_resource_report": false}}